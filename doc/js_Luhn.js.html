<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: js/Luhn.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: js/Luhn.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @type {number} logitud of credit card code
 * 
 */
const CARD_CODE_LENGTH = 16;

/**
 * 
 * This is the load function, the DOM selectors are loaded and events are added to validate the credit 
 * card number entered by the user.
 * 
 */
window.onload = () => {
    $form = document.querySelector('.luhn-form');

    $form.addEventListener('submit', (event) => {
        event.preventDefault();
        let form = new FormData($form);
        let cardCode = form.get('cardCode');
        if (cardCode.includes(' ')) cardCode = removeSpaces(cardCode);

        let result = document.querySelector('.result');
        if (cardCode == 0) result.innerHTML = ''
        else (cardCode.length !== CARD_CODE_LENGTH) ? result.innerHTML = `&lt;label style="color:#991B1B">c칩digo no v치lido&lt;/label>` : result.innerHTML = this.validateCreditCard(cardCode);
    })
}

/**
 * 
 * This is a function for validation credit cards number the digits of the entered number are added, 
 * following the rule of the even positions multiply by 2 and the odd positions leave it the same
 * in order to validate if the calculated control number is equal to the entered
 * 
 * @param {string} cardCode number credit card entered for user
 * @returns returns if the number of credit card is valid or not and the type of card
 * 
 */
function validateCreditCard(cardCode) {
    let sumDigits = 0;
    let verificationDigit = cardCode.slice(-1);
    for (let index = 0; index &lt; CARD_CODE_LENGTH - 1; index++) {
        if (index % 2 == 0) {
            sumDigits += (cardCode[index] * 2 >= 10) ? sumDigitsNumber(cardCode[index] * 2) : cardCode[index] * 2;
        }
        else sumDigits += Number(cardCode[index]);
    }
    if (10 - (sumDigits % 10) == verificationDigit) return `Tarjeta v치lida ${verifyCardType(cardCode, card)}`;
    else return 'Tarjeta no v치lida ';
}

/**
 * 
 * @param {number} number number of two or more digits that results of the validations process 
 * @returns sum of the consecutive digits of the number
 * 
 */
function sumDigitsNumber(number) {
    let sumNumberDigits = 0;
    number.toString().split('').forEach(index => sumNumberDigits += parseInt(index));
    return sumNumberDigits;
}

/**
 * 
 * @param {string} cardCode number credit card entered for user
 * @param {Array} card list card available whith code and type
 * @returns {object} type credit card entered
 * 
 */
function verifyCardType(cardCode, card) {
    let cardType = card.map(cardType => {
        if (cardCode.slice(0, 1).includes(cardType.code)) return cardType.name
    }).filter(Boolean);
    return (card.length !== 0) ? cardType : '';
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#card">card</a></li><li><a href="global.html#CARD_CODE_LENGTH">CARD_CODE_LENGTH</a></li><li><a href="global.html#countries">countries</a></li><li><a href="global.html#devURLBase">devURLBase</a></li><li><a href="global.html#EAN_THIRTEEN_LENGTH">EAN_THIRTEEN_LENGTH</a></li><li><a href="global.html#padLeft">padLeft</a></li><li><a href="global.html#redirectTo">redirectTo</a></li><li><a href="global.html#removeSpaces">removeSpaces</a></li><li><a href="global.html#roundedSum">roundedSum</a></li><li><a href="global.html#sumDigits">sumDigits</a></li><li><a href="global.html#sumDigitsNumber">sumDigitsNumber</a></li><li><a href="global.html#URLBase">URLBase</a></li><li><a href="global.html#validateCreditCard">validateCreditCard</a></li><li><a href="global.html#verifyCardType">verifyCardType</a></li><li><a href="global.html#verifyCheckDigit">verifyCheckDigit</a></li><li><a href="global.html#verifyCountry">verifyCountry</a></li><li><a href="global.html#verifyEANCode">verifyEANCode</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.7</a> on Tue Aug 17 2021 22:34:26 GMT-0500 (Colombia Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
